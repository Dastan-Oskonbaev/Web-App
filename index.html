<script src="https://unpkg.com/html5-qrcode"></script>

<!-- Контейнер для QR-сканера -->
<div id="reader" style="width: 300px;"></div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const html5QrCode = new Html5Qrcode("reader");

        html5QrCode.start(
            { facingMode: "environment" },
            { fps: 10, qrbox: 250 },
            qrCodeMessage => {
                // Останавливаем сканер, чтобы не отправляло несколько раз
                html5QrCode.stop().then(() => {
                    // Отправка данных в Telegram WebApp
                    if (window.Telegram && Telegram.WebApp) {
                        Telegram.WebApp.sendData(qrCodeMessage);
                        Telegram.WebApp.close();
                    } else {
                        console.error("Telegram WebApp не найден");
                    }
                }).catch(err => {
                    console.error("Ошибка остановки сканера:", err);
                });
            }
        );
    });
</script>
